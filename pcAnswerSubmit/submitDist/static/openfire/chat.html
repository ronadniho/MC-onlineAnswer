<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>聊天</title>
    <!--jquery-->
    <script src="./common/jquery-1.9.0.js" type="text/javascript"></script>
    <script src="./common/json2.js" type="text/javascript"></script>



    <!-- openfire设置 -->
    <script type="text/javascript" src='../scripts/openfire.setting.js'></script>
    <!-- karma插件 -->
    <script type="text/javascript" src='./scripts/karmawidgets/plugin.js'></script>
    <!-- 聊天插件 -->
    <script type="text/javascript" src='./scripts/config.js'></script>
    <script type="text/javascript" src='./scripts/strophe.js'></script>
    <script type="text/javascript" src='./scripts/strophe.muc.js'></script>
    <script type="text/javascript" src='./scripts/strophe.muc.extend.js'></script>
    <script type="text/javascript" src='./scripts/active.chat.js'></script>



    <script type="text/javascript"`>
        let msg = {
            "ID": "0068805d37a54f4896e2e17a7be3df16",    //题目ID
            "QUESTIONS_CONTENT": "五年来，我们勇于面对党面临的重大风险考验和党内存在的突出问题，以顽强意志品质正风肃纪、反腐惩恶，消除了党和国家内部存在的严重隐患，党内政治生活气象更新，党内政治生态明显好转，",  //题目内容
            "OPTION_CONTENT": "创造力|创新力|凝聚力|战斗力",   //题目选项，前台不用
            "QUESTIONS_TYPE": "1",   //题目类型，1是多选
            "REFERENCE_ANSWER": "创造力|创新力",   //参考答案
            "VALUE": "3",      //分值
            "ENTRY_TIME": "2018-05-30 15:17:31.0",      //题目导入时间
            "option_content":       //题目选项，前台用
            ["创新力",
                "创造力",
                "凝聚力",
                "战斗力"],
            "reference_answer"://题目正确答案，前台用，如果只有一个答案就是字符串
            ["创造力",
                "创新力"]
        };
        $(document).ready(function () {
            JoinRoomProcess();
        });

        //加入聊天室
        function JoinRoomProcess() {
            clientChat.Chat("openfireadmin0001", "125132355155885", receiveMessage, function () {
                console.log("加入成功回调,可以开始发送消息");
            });
        }
        //发送消息
        function sendMsg() {
            clientChat.SendJson(msg);
        }
        //接收消息
        //IsSelfMsg 该消息是否为用户发出的
        function receiveMessage(msg, IsSelfMsg) {
            if (IsSelfMsg) {
                //这里主要来检测发送出去的消息是否成功分发到聊天室内
                let msg_json = $.parseJSON(msg.content);
                console.log("1");
                console.log(msg_json);
            }
            else {
                let msg_json = $.parseJSON(msg.content);
                console.log("2");
                console.log(msg_json);
            }
            return false;
        }



    </script>
</head>
<body>
   <button onclick="sendMsg();">Send</button>
</body>
</html>
